<% @products.each do |product| %>
<div class="col-md-4">
  <div class="thumbnail well check-product" id="<%= product.id %>" data-toggle="modal" data-target="#checkProductPanel">
    <% if product.product_images.all.length == 0 %>
    <div class="text-center thumbnail-image thumbnail-image-square" style="background:url(http://placehold.it/150x150/fff/ffffff&text='');background-size: 100% 100%;
    background-repeat: no-repeat;"><span class="glyphicon-md glyphicon glyphicon glyphicon-apple"></span></div>
    <% else %>
    <div class="text-center thumbnail-image thumbnail-image-square" style="background: url(<%= product.product_images.all.first.image.url(:medium)%>); background-size: 100% 100%;
      background-repeat: no-repeat;"></div>
      <% end %>

      <div class="caption">
        <div class="card-title text-overflow"><%= product.name%></div>
        <div class="row">
            <span class="glyphicon-sm glyphicon glyphicon-piggy-bank"></span>
            <span class="label btn-tags label-success"><%= product.price%></span>
              <% if product.is_special == true%>
              <span class="label btn-tags label-danger">Special</span>
              <% end %>
        </div>
        <% if split_tags(product.tag).length > 0 %>
        <div class="row">
            <span class="glyphicon-sm glyphicon glyphicon-tag"></span>
            <span class="tags">
              <% split_tags(product.tag)[0..2].each do |tag| %>
              <span class="tag"><a class="btn btn-tags btn-success" style="background: <%=tag_color[tag]%>"><%= tag %></a></span>
              <% end %>
            </span>
        </div>
        <% end %>
      </div>
    </div>
  </div>

  <% end %>
  <script>
  $(document).ready(function() {
    $('.check-product').click(function(){
      var id = $(this).attr('id')
      $.ajax({
        url: "/products/" + id,
        dataType: "html",
        type: "GET",
        success: function(data, success) {
          $('#checkProductPanel .modal-body').empty()
          $('#checkProductPanel .modal-body').append(data);
        },
        error: function(data, failure) {
          alert("Something Wrong Happen, Please try it later");
        }
      });
    });
  });
  </script>
